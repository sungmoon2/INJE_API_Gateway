---
version: v1.0.1
session: 1
created: 2025-09-16T14:58:27Z
updated: 2025-09-17T02:50:00Z
duration: 11h 51m 33s
status: completed
next_version: v1.0.2
category: development
milestone: "Complete API Gateway implementation"
---

# ğŸ“‹ INJE API Gateway - Session 1 Complete Development Log

================================================================================
INJE API GATEWAY í”„ë¡œì íŠ¸ ì™„ì „ ê°œë°œ ì¼ì§€
================================================================================

í”„ë¡œì íŠ¸ ì •ë³´:
- í”„ë¡œì íŠ¸ëª…: INJE API Gateway for KULS System Integration
- ê°œë°œ ê¸°ê°„: 2025-09-16 (ë‹¨ì¼ ì„¸ì…˜)
- ëª©ì : INJE ëŒ€í•™êµ KULS ì‹œìŠ¤í…œê³¼ Hyperledger Fabric ë¸”ë¡ì²´ì¸ ë„¤íŠ¸ì›Œí¬ ì—°ë™
- ìœ„ì¹˜: /home/minsujo/inje-api-gateway

================================================================================
1. í™˜ê²½ ë° ê¸°ìˆ  ìŠ¤íƒ
================================================================================

ìš´ì˜ì²´ì œ ë° í”Œë«í¼:
- OS: Linux 6.8.0-79-generic
- Platform: linux
- ì‘ì—… ë””ë ‰í† ë¦¬: /home/minsujo/inje-api-gateway

Node.js í™˜ê²½:
- Node.js ë²„ì „: 18+ (enginesì—ì„œ ëª…ì‹œ)
- íŒ¨í‚¤ì§€ ë§¤ë‹ˆì €: npm
- TypeScript ë²„ì „: ^5.7.2
- ê°œë°œ ì„œë²„: nodemon + ts-node

í•µì‹¬ í”„ë ˆì„ì›Œí¬:
- Express.js: ^4.21.2 (ì›¹ í”„ë ˆì„ì›Œí¬)
- TypeScript: ì™„ì „ íƒ€ì… ì•ˆì „ì„±
- Winston: ^3.19.0 (êµ¬ì¡°í™”ëœ ë¡œê¹…)

ë¸”ë¡ì²´ì¸ ì—°ë™:
- fabric-network: ^2.2.20 (Hyperledger Fabric SDK)
- fabric-ca-client: ^2.2.20 (CA í´ë¼ì´ì–¸íŠ¸)

ë°ì´í„°ë² ì´ìŠ¤ ë° ìºì‹œ:
- Redis (ioredis): ^5.4.1
- ì—°ê²°í’€, Pub/Sub, Rate Limiting, ë¶„ì‚°ë½ ì§€ì›

ë³´ì•ˆ ë° ë¯¸ë“¤ì›¨ì–´:
- helmet: ^8.0.0 (ë³´ì•ˆ í—¤ë”)
- cors: ^2.8.5 (CORS ì„¤ì •)
- API í‚¤ ê¸°ë°˜ ì¸ì¦
- HMAC ì„œëª… ê²€ì¦ (ì›¹í›…)

HTTP í´ë¼ì´ì–¸íŠ¸:
- axios: ^1.7.9 (ì™¸ë¶€ API í˜¸ì¶œ)

ê°œë°œ ë„êµ¬:
- nodemon: ^3.1.10 (í•« ë¦¬ë¡œë“œ)
- ts-node: ^10.9.2 (TypeScript ì§ì ‘ ì‹¤í–‰)
- @types/* íŒ¨í‚¤ì§€ë“¤ (íƒ€ì… ì •ì˜)

ì»¨í…Œì´ë„ˆí™”:
- Docker: ë©€í‹° ìŠ¤í…Œì´ì§€ ë¹Œë“œ
- Docker Compose: ì„œë¹„ìŠ¤ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜
- Redis: redis:7.2-alpine

================================================================================
2. í”„ë¡œì íŠ¸ êµ¬ì¡° ë° ì•„í‚¤í…ì²˜
================================================================================

ë””ë ‰í† ë¦¬ êµ¬ì¡°:
```
/home/minsujo/inje-api-gateway/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts                 (ë©”ì¸ ì„œë²„ ì§„ì…ì )
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ redis.service.ts     (Redis í´ë¼ì´ì–¸íŠ¸)
â”‚   â”‚   â”œâ”€â”€ fabric.service.ts    (Fabric ë„¤íŠ¸ì›Œí¬ ì—°ë™)
â”‚   â”‚   â””â”€â”€ webhook.service.ts   (ì›¹í›… ì²˜ë¦¬)
â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”œâ”€â”€ auth.middleware.ts   (API í‚¤ ì¸ì¦)
â”‚   â”‚   â”œâ”€â”€ rateLimit.middleware.ts (ë ˆì´íŠ¸ ë¦¬ë¯¸íŒ…)
â”‚   â”‚   â””â”€â”€ error.middleware.ts  (ê¸€ë¡œë²Œ ì—ëŸ¬ í•¸ë“¤ë§)
â”‚   â””â”€â”€ routes/
â”‚       â”œâ”€â”€ fabric.routes.ts     (íŠ¸ëœì­ì…˜ API)
â”‚       â””â”€â”€ webhook.routes.ts    (ì›¹í›… ê´€ë¦¬ API)
â”œâ”€â”€ config/                      (ì„¤ì • íŒŒì¼ ë””ë ‰í† ë¦¬)
â”œâ”€â”€ logs/                        (ë¡œê·¸ íŒŒì¼ ì €ì¥)
â”œâ”€â”€ wallet/                      (Fabric ì§€ê°‘)
â”œâ”€â”€ dist/                        (ì»´íŒŒì¼ëœ JavaScript)
â”œâ”€â”€ node_modules/                (ì˜ì¡´ì„±)
â”œâ”€â”€ package.json                 (í”„ë¡œì íŠ¸ ì„¤ì •)
â”œâ”€â”€ tsconfig.json               (TypeScript ì„¤ì •)
â”œâ”€â”€ .env                        (í™˜ê²½ ë³€ìˆ˜)
â”œâ”€â”€ Dockerfile                  (ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€)
â”œâ”€â”€ Dockerfile.simulator        (KULS ì‹œë®¬ë ˆì´í„°)
â”œâ”€â”€ docker-compose.yml          (ì„œë¹„ìŠ¤ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜)
â””â”€â”€ .dockerignore              (Docker ë¹Œë“œ ì œì™¸)
```

ì•„í‚¤í…ì²˜ íŒ¨í„´:
- Singleton Pattern: ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬
- Factory Pattern: ì—ëŸ¬ ìƒì„± ë° Rate Limiter ìƒì„±
- Observer Pattern: Redis Pub/Sub
- Middleware Pattern: Express.js ë¯¸ë“¤ì›¨ì–´ ì²´ì¸
- Repository Pattern: Redis ë°ì´í„° ì ‘ê·¼

================================================================================
3. ê°œë°œ ê³¼ì • ìƒì„¸ ì¶”ì 
================================================================================

3.1 í”„ë¡œì íŠ¸ ì´ˆê¸°í™” ë‹¨ê³„
------------------------
ì‹¤í–‰ ëª…ë ¹ì–´:
- `npm init -y` (package.json ìƒì„±)
- `npm install` (ì˜ì¡´ì„± ì„¤ì¹˜)

ìƒì„±ëœ íŒŒì¼:
- package.json: ìŠ¤í¬ë¦½íŠ¸ ë° ì˜ì¡´ì„± ì •ì˜
- tsconfig.json: TypeScript ì»´íŒŒì¼ ì˜µì…˜
- .env: í™˜ê²½ ë³€ìˆ˜ (22ê°œ ì„¤ì •)

ì˜ì¡´ì„± ì„¤ì¹˜:
Runtime Dependencies:
- express@^4.21.2
- fabric-network@^2.2.20
- fabric-ca-client@^2.2.20
- ioredis@^5.4.1
- winston@^3.19.0
- axios@^1.7.9
- helmet@^8.0.0
- cors@^2.8.5
- dotenv@^17.2.2
- crypto (ë‚´ì¥)

Development Dependencies:
- typescript@^5.7.2
- @types/node@^22.10.2
- @types/express@^5.0.0
- @types/cors@^2.8.17
- ts-node@^10.9.2
- nodemon@^3.1.10
- jest@^29.7.0
- @types/jest@^29.5.14

3.2 í•µì‹¬ ì„œë¹„ìŠ¤ êµ¬í˜„ ë‹¨ê³„
-------------------------

Redis ì„œë¹„ìŠ¤ (redis.service.ts):
- ì‹±ê¸€í†¤ íŒ¨í„´ êµ¬í˜„
- ì—°ê²°í’€ ê´€ë¦¬ (client, subscriber, publisher)
- ì¬ì—°ê²° ë¡œì§ ë° ì—ëŸ¬ í•¸ë“¤ë§
- êµ¬í˜„ëœ ë©”ì†Œë“œ:
  * Key-Value: get, set, setex, del, exists, expire, ttl
  * List: lpush, rpush, lpop, rpop, llen, lrange, lrem
  * Sorted Set: zadd, zrem, zrange, zrangebyscore, zcard
  * Pub/Sub: publish, subscribe, unsubscribe
  * ìœ í‹¸ë¦¬í‹°: keys, scan, ping, incr, decr
  * Rate Limiting: checkRateLimit
  * ë¶„ì‚°ë½: acquireLock, releaseLock

Fabric ì„œë¹„ìŠ¤ (fabric.service.ts):
- Gateway íŒ¨í„´ìœ¼ë¡œ ë„¤íŠ¸ì›Œí¬ ì—°ê²°
- ì§€ê°‘ ê´€ë¦¬ (FileSystemWallet)
- ê°œë°œ/í”„ë¡œë•ì…˜ ëª¨ë“œ ë¶„ê¸°
- Mock ëª¨ë“œ êµ¬í˜„ (ê°œë°œ í™˜ê²½ìš©)
- íŠ¸ëœì­ì…˜ ë¼ì´í”„ì‚¬ì´í´ ê´€ë¦¬:
  * submitTransaction: íŠ¸ëœì­ì…˜ ì œì¶œ
  * submitMockTransaction: ê°œë°œìš© ëª¨ì˜ íŠ¸ëœì­ì…˜
  * registerBlockListener: ë¸”ë¡ ì´ë²¤íŠ¸ ì²˜ë¦¬
  * getTransactionStatus: ìƒíƒœ ì¡°íšŒ
- ë©±ë“±ì„± ë³´ì¥ (correlationId ê¸°ë°˜)

ì›¹í›… ì„œë¹„ìŠ¤ (webhook.service.ts):
- ë¹„ë™ê¸° í ê¸°ë°˜ ì²˜ë¦¬
- ì¬ì‹œë„ ë¡œì§ (exponential backoff)
- Dead Letter Queue (DLQ) êµ¬í˜„
- HMAC ì„œëª… ìƒì„±
- êµ¬í˜„ëœ ê¸°ëŠ¥:
  * addWebhookJob: ì‘ì—… ì¶”ê°€
  * processQueue: ë©”ì¸ í ì²˜ë¦¬
  * processRetryQueue: ì¬ì‹œë„ í ì²˜ë¦¬
  * sendWebhook: HTTP ìš”ì²­ ì „ì†¡
  * handleWebhookError: ì—ëŸ¬ ì²˜ë¦¬
  * moveToDeadLetterQueue: DLQ ì´ë™
  * reprocessDLQ: DLQ ì¬ì²˜ë¦¬

3.3 ë¯¸ë“¤ì›¨ì–´ êµ¬í˜„ ë‹¨ê³„
---------------------

ì¸ì¦ ë¯¸ë“¤ì›¨ì–´ (auth.middleware.ts):
- API í‚¤ ê¸°ë°˜ ì¸ì¦
- í—¤ë” ê²€ì¦: X-API-Key, Authorization Bearer
- ì‚¬ìš©ì ì‹ë³„ì ìƒì„±
- ì„ íƒì  ì¸ì¦ ì§€ì›

Rate Limiting ë¯¸ë“¤ì›¨ì–´ (rateLimit.middleware.ts):
- Redis ê¸°ë°˜ ë¶„ì‚° Rate Limiting
- ì„¤ì • ê°€ëŠ¥í•œ ì œí•œ ì •ì±…
- ì‚¬ìš©ìë³„/IPë³„ ì œí•œ
- HTTP í—¤ë” ì¶”ê°€:
  * X-RateLimit-Limit
  * X-RateLimit-Remaining
  * X-RateLimit-Reset
  * X-RateLimit-Window

ì—ëŸ¬ í•¸ë“¤ë§ ë¯¸ë“¤ì›¨ì–´ (error.middleware.ts):
- ê¸€ë¡œë²Œ ì—ëŸ¬ ìºì²˜
- Axios ì—ëŸ¬ íŠ¹ë³„ ì²˜ë¦¬
- í™˜ê²½ë³„ ì—ëŸ¬ ì •ë³´ ë…¸ì¶œ ì œì–´
- êµ¬ì¡°í™”ëœ ì—ëŸ¬ ì‘ë‹µ
- ì»¤ìŠ¤í…€ ì—ëŸ¬ í´ë˜ìŠ¤ (ApiError)

3.4 API ë¼ìš°í„° êµ¬í˜„ ë‹¨ê³„
-----------------------

Fabric ë¼ìš°í„° (fabric.routes.ts):
êµ¬í˜„ëœ ì—”ë“œí¬ì¸íŠ¸:
- POST /api/v1/transactions/submit: íŠ¸ëœì­ì…˜ ì œì¶œ
- GET /api/v1/transactions/status/:correlationId: ìƒíƒœ ì¡°íšŒ
- GET /api/v1/transactions/tx/:txId/status: txIdë¡œ ìƒíƒœ ì¡°íšŒ
- GET /api/v1/transactions: íŠ¸ëœì­ì…˜ ëª©ë¡ (í˜ì´ì§€ë„¤ì´ì…˜)
- POST /api/v1/transactions/retry/:correlationId: ì¬ì‹œë„

ì›¹í›… ë¼ìš°í„° (webhook.routes.ts):
êµ¬í˜„ëœ ì—”ë“œí¬ì¸íŠ¸:
- GET /api/v1/webhooks/status: ì„œë¹„ìŠ¤ ìƒíƒœ
- POST /api/v1/webhooks/dlq/reprocess: DLQ ì¬ì²˜ë¦¬
- GET /api/v1/webhooks/dlq: DLQ ë‚´ìš© ì¡°íšŒ
- POST /api/v1/webhooks/retry/:jobId: íŠ¹ì • ì‘ì—… ì¬ì‹œë„
- GET /api/v1/webhooks/history/:correlationId: ì „ì†¡ íˆìŠ¤í† ë¦¬
- POST /api/v1/webhooks/test: ìˆ˜ë™ í…ŒìŠ¤íŠ¸

3.5 ì„œë²„ ì„¤ì • ë° ì´ˆê¸°í™” (index.ts)
--------------------------------
- Express ì•± ì´ˆê¸°í™”
- ì „ì—­ ë¯¸ë“¤ì›¨ì–´ ì„¤ì •:
  * helmet (ë³´ì•ˆ í—¤ë”)
  * cors (CORS ì„¤ì •)
  * JSON íŒŒì‹± (10MB ì œí•œ)
  * Request ID ìƒì„±
- ë¼ìš°í„° ë“±ë¡
- 404 í•¸ë“¤ëŸ¬
- ê¸€ë¡œë²Œ ì—ëŸ¬ í•¸ë“¤ëŸ¬
- Graceful Shutdown êµ¬í˜„

================================================================================
4. TypeScript ì»´íŒŒì¼ ì—ëŸ¬ ìˆ˜ì • ê³¼ì •
================================================================================

ìˆ˜ì •ëœ íƒ€ì… ì—ëŸ¬ë“¤:

4.1 ë¯¸ì‚¬ìš© ë§¤ê°œë³€ìˆ˜ ì²˜ë¦¬:
- req â†’ _req (ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ë§¤ê°œë³€ìˆ˜)
- res â†’ _res
- next â†’ _next
- job â†’ _job

4.2 íƒ€ì… ì•ˆì „ì„± ê°œì„ :
- Request.ip: string | undefined â†’ string ì²˜ë¦¬
- AxiosError íƒ€ì… ìºìŠ¤íŒ… ì¶”ê°€
- CustomError ì¸í„°í˜ì´ìŠ¤ ê°œì„ 
- ì˜µì…”ë„ ì†ì„± ì•ˆì „í•œ ì ‘ê·¼

4.3 Redis í´ë¼ì´ì–¸íŠ¸ ë©”ì†Œë“œ ìˆ˜ì •:
- scan() ë©”ì†Œë“œ ë§¤ê°œë³€ìˆ˜ íƒ€ì… ìˆ˜ì •
- lrem() ë©”ì†Œë“œ ì¶”ê°€

4.4 Fabric ì„œë¹„ìŠ¤ íƒ€ì… ìˆ˜ì •:
- wallet, network, contractë¥¼ ì˜µì…”ë„ë¡œ ë³€ê²½
- ë¸”ë¡ ë°ì´í„° íƒ€ì… ì•ˆì „ì„± ê°œì„ 

4.5 ì œê±°ëœ ë¯¸ì‚¬ìš© imports:
- crypto (fabric.routes.ts)
- FabricCAServices (fabric.service.ts)
- AxiosError (webhook.service.ts)
- webhookService ë³€ìˆ˜

ìµœì¢… ì»´íŒŒì¼ ê²°ê³¼: âœ… ì—ëŸ¬ ì—†ìŒ

================================================================================
5. Docker ì»¨í…Œì´ë„ˆí™” êµ¬ì„±
================================================================================

5.1 ë©”ì¸ Dockerfile:
- ë² ì´ìŠ¤ ì´ë¯¸ì§€: node:18-alpine
- ë©€í‹° ìŠ¤í…Œì´ì§€ ë¹Œë“œ (base, development)
- í”„ë¡œë•ì…˜ìš© ìµœì í™”
- í¬íŠ¸ 3000 ë…¸ì¶œ

5.2 ì‹œë®¬ë ˆì´í„° Dockerfile:
- KULS ì‹œìŠ¤í…œ ì‹œë®¬ë ˆì´í„°
- Express ì„œë²„ë¡œ ì›¹í›… ìˆ˜ì‹ 
- í…ŒìŠ¤íŠ¸ íŠ¸ëœì­ì…˜ ì œì¶œ ê¸°ëŠ¥

5.3 Docker Compose ì„¤ì •:
ì„œë¹„ìŠ¤:
- redis: Redis 7.2-alpine
- api-gateway: ë©”ì¸ API Gateway
- kuls-simulator: í…ŒìŠ¤íŠ¸ìš© ì‹œë®¬ë ˆì´í„°

ë„¤íŠ¸ì›Œí¬:
- inje-network (bridge, 172.20.0.0/16)

ë³¼ë¥¨:
- redis-data: Redis ë°ì´í„° ì˜êµ¬ ì €ì¥

í™˜ê²½ ë³€ìˆ˜:
- NODE_ENV=development
- REDIS_HOST=redis
- API í‚¤ ë° ë³´ì•ˆ ì„¤ì •

5.4 .dockerignore:
- node_modules, logs, wallet
- ê°œë°œ íŒŒì¼ ì œì™¸
- Git ë° IDE íŒŒì¼ ì œì™¸

================================================================================
6. ì‹¤í–‰ í…ŒìŠ¤íŠ¸ ë° ê²€ì¦
================================================================================

6.1 ë¡œì»¬ í™˜ê²½ ì‹¤í–‰:
ëª…ë ¹ì–´: PORT=3001 npm run dev
ê²°ê³¼: âœ… ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰

ì„œë¹„ìŠ¤ ìƒíƒœ:
- Redis: âœ… ì—°ê²° ì„±ê³µ (localhost:6379)
- Fabric: âš ï¸ Mock ëª¨ë“œ (ê°œë°œ í™˜ê²½)
- Express: âœ… í¬íŠ¸ 3001ì—ì„œ ì‹¤í–‰

6.2 API í…ŒìŠ¤íŠ¸ ê²°ê³¼:

Health Check:
```bash
curl -s http://localhost:3001/health
```
ì‘ë‹µ:
```json
{
  "status": "healthy",
  "timestamp": "2025-09-16T14:58:44.049Z",
  "uptime": 18.636526727,
  "environment": "development"
}
```

API ì •ë³´:
```bash
curl -s http://localhost:3001/api/v1
```
ì‘ë‹µ:
```json
{
  "version": "1.0.0",
  "description": "INJE Private Blockchain API Gateway",
  "endpoints": {
    "transactions": "/api/v1/transactions",
    "status": "/api/v1/transactions/:txId/status",
    "health": "/health"
  }
}
```

íŠ¸ëœì­ì…˜ ì œì¶œ:
```bash
curl -X POST http://localhost:3001/api/v1/transactions/submit \
  -H "Content-Type: application/json" \
  -H "X-API-Key: kuls-api-key-2025" \
  -d '{"correlationId": "test-123-456", "containerId": "CONTAINER-001", "instruction": "LOAD_CARGO", "source": "KULS_SYSTEM", "callbackUrl": "http://localhost:4000/webhook"}'
```
ì‘ë‹µ:
```json
{
  "success": true,
  "message": "Transaction submitted successfully",
  "data": {
    "correlationId": "test-123-456",
    "txId": "tx_1758034824058_f7t7x9",
    "status": "SUBMITTED",
    "timestamp": "2025-09-16T15:00:24.059Z"
  }
}
```

ìƒíƒœ ì¡°íšŒ:
```bash
curl -s http://localhost:3001/api/v1/transactions/status/test-123-456 \
  -H "X-API-Key: kuls-api-key-2025"
```
ì‘ë‹µ:
```json
{
  "success": true,
  "data": {
    "correlationId": "test-123-456",
    "txId": "tx_1758034824058_f7t7x9",
    "status": "COMMITTED",
    "blockNumber": 227,
    "payloadHash": "sha256:acc5496c6e2f2f6907d001c9a7fb9e4572b596f4cc26be79f1f686bb3082f5ef",
    "retrievedAt": "2025-09-16T15:00:30.445Z"
  }
}
```

ì›¹í›… ì„œë¹„ìŠ¤ ìƒíƒœ:
```bash
curl -s http://localhost:3001/api/v1/webhooks/status
```
ì‘ë‹µ:
```json
{
  "success": true,
  "data": {
    "service": "webhook",
    "queue": 1,
    "retry": 0,
    "dlq": 0,
    "processing": false,
    "timestamp": "2025-09-16T15:00:36.904Z"
  }
}
```

6.3 Mock íŠ¸ëœì­ì…˜ ì‹œë®¬ë ˆì´ì…˜:
- 5ì´ˆ í›„ ìë™ìœ¼ë¡œ COMMITTED ìƒíƒœë¡œ ë³€ê²½
- ëœë¤ ë¸”ë¡ ë²ˆí˜¸ ìƒì„± (227)
- SHA256 í•´ì‹œ ìƒì„±
- ì›¹í›… íì— ìë™ ì¶”ê°€

================================================================================
7. Fabric Network ê´€ë ¨ ìˆ˜ì •ì‚¬í•­
================================================================================

7.1 ì´ì „ ì„¸ì…˜ì—ì„œ ìˆ˜ì •ëœ Fabric Network ì´ìŠˆ:
ìœ„ì¹˜: /home/minsujo/fabric-network/docker/docker-compose-desktop1.yaml

ë¬¸ì œ: BCCSP ì„¤ì • ì˜¤ë¥˜ë¡œ ì¸í•œ í”¼ì–´ ì»¨í…Œì´ë„ˆ ì‹œì‘ ì‹¤íŒ¨
ì—ëŸ¬ ë©”ì‹œì§€: "Cannot run peer because could not get peer BCCSP configuration"

ì ìš©ëœ ìˆ˜ì •ì‚¬í•­:
```yaml
peer0.cfs1.example.com:
  environment:
    - FABRIC_CFG_PATH=/etc/hyperledger/fabric/config  # ì¶”ê°€
  volumes:
    - ../config:/etc/hyperledger/fabric/config        # ì¶”ê°€
    - ../crypto-config/peerOrganizations/cfs1.example.com/peers/peer0.cfs1.example.com/msp:/etc/hyperledger/fabric/msp
    - peer0.cfs1.example.com:/var/hyperledger/production
```

ê²°ê³¼: âœ… í”¼ì–´ ì»¨í…Œì´ë„ˆ ì •ìƒ ì‹œì‘

7.2 í˜„ì¬ API Gatewayì˜ Fabric ì—°ë™ ìƒíƒœ:
- Connection Profile: ê¸°ë³¸ ì„¤ì • ì‚¬ìš© (ì‹¤ì œ ë„¤íŠ¸ì›Œí¬ ë¯¸ì—°ê²°)
- Identity ê´€ë¦¬: ê°œë°œìš© Mock Identity ìƒì„±
- íŠ¸ëœì­ì…˜ ì²˜ë¦¬: Mock ëª¨ë“œë¡œ ì‹œë®¬ë ˆì´ì…˜
- í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” ì‹¤ì œ Fabric ë„¤íŠ¸ì›Œí¬ ì—°ê²° ê°€ëŠ¥

Mock ëª¨ë“œ êµ¬í˜„ ì„¸ë¶€ì‚¬í•­:
- submitMockTransaction(): 5ì´ˆ í›„ COMMITTED ìƒíƒœ ë³€ê²½
- ì„ì˜ ë¸”ë¡ ë²ˆí˜¸ ë° í•´ì‹œ ìƒì„±
- Redisì— ìƒíƒœ ì €ì¥
- ì›¹í›… íì— ì™„ë£Œ ì´ë²¤íŠ¸ ì¶”ê°€

================================================================================
8. í™˜ê²½ ì„¤ì • ë° ë³´ì•ˆ
================================================================================

8.1 í™˜ê²½ ë³€ìˆ˜ (.env):
```
# Server Configuration
NODE_ENV=development
PORT=3000
LOG_LEVEL=debug

# Fabric Configuration
FABRIC_CONNECTION_PROFILE=./config/connection-profile.json
FABRIC_CHANNEL_NAME=newportchannel
FABRIC_CHAINCODE_NAME=inje-chaincode
FABRIC_CONTRACT_NAME=LogisticsContract
FABRIC_USER_ID=appUser
FABRIC_MSP_ID=CFS1MSP

# Fabric CA Configuration
FABRIC_CA_URL=http://localhost:7054
FABRIC_CA_CONFIG=./config/ca-config.json
FABRIC_CA_ADMIN_ID=admin
FABRIC_CA_ADMIN_SECRET=adminpw

# Redis Configuration
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Security
API_KEYS=kuls-api-key-2025,test-api-key,kuls-test-key-2025
WEBHOOK_SECRET=inje-webhook-secret-2025
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:4000,https://api.kuls.ac.kr

# Rate Limiting
RATE_LIMIT_WINDOW=60000
RATE_LIMIT_MAX_REQUESTS=100
```

8.2 ë³´ì•ˆ ì„¤ì •:
- API í‚¤ ê¸°ë°˜ ì¸ì¦ (3ê°œ í‚¤ ë“±ë¡)
- CORS ì„¤ì • (í—ˆìš©ëœ ì˜¤ë¦¬ì§„ë§Œ)
- Helmet ë³´ì•ˆ í—¤ë”
- HMAC ì„œëª… ê²€ì¦ (ì›¹í›…)
- Rate Limiting (ë¶„ì‚° í™˜ê²½ ëŒ€ì‘)

================================================================================
9. ë¡œê¹… ë° ëª¨ë‹ˆí„°ë§
================================================================================

9.1 Winston ë¡œê±° ì„¤ì •:
- êµ¬ì¡°í™”ëœ JSON ë¡œê¹…
- ì„œë¹„ìŠ¤ë³„ ë©”íƒ€ë°ì´í„°
- íŒŒì¼ ë° ì½˜ì†” ì¶œë ¥
- ë¡œê·¸ ë ˆë²¨ ì„¤ì • ê°€ëŠ¥

9.2 ë¡œê·¸ íŒŒì¼ êµ¬ì¡°:
- logs/error.log: ì—ëŸ¬ ë ˆë²¨ë§Œ
- logs/combined.log: ëª¨ë“  ë ˆë²¨
- logs/redis.log: Redis ê´€ë ¨
- logs/fabric.log: Fabric ê´€ë ¨
- logs/webhook.log: ì›¹í›… ê´€ë ¨
- logs/auth.log: ì¸ì¦ ê´€ë ¨
- logs/ratelimit.log: Rate Limiting

9.3 ëª¨ë‹ˆí„°ë§ ì—”ë“œí¬ì¸íŠ¸:
- /health: ì„œë²„ ìƒíƒœ
- /api/v1/webhooks/status: ì›¹í›… í ìƒíƒœ
- Request ID ì¶”ì  ê°€ëŠ¥

================================================================================
10. ì„±ëŠ¥ ë° í™•ì¥ì„±
================================================================================

10.1 Redis ìµœì í™”:
- ì—°ê²°í’€ ì‚¬ìš© (client, subscriber, publisher)
- ì¬ì—°ê²° ë¡œì§
- ë¶„ì‚° ë½ êµ¬í˜„
- TTL ê¸°ë°˜ ë°ì´í„° ê´€ë¦¬

10.2 ë¹„ë™ê¸° ì²˜ë¦¬:
- ì›¹í›… í ì‹œìŠ¤í…œ
- ë…¼ë¸”ë¡œí‚¹ I/O
- Promise ê¸°ë°˜ API

10.3 í™•ì¥ ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜:
- ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŒ¨í„´
- Docker ì»¨í…Œì´ë„ˆí™”
- ë¡œë“œ ë°¸ëŸ°ì‹± ì¤€ë¹„
- ìƒíƒœ ë¹„ì €ì¥ ì„¤ê³„

================================================================================
11. í…ŒìŠ¤íŠ¸ ë° í’ˆì§ˆ ë³´ì¦
================================================================================

11.1 ìˆ˜ë™ í…ŒìŠ¤íŠ¸ ì™„ë£Œ:
- âœ… ì„œë²„ ì‹œì‘/ì¢…ë£Œ
- âœ… API ì—”ë“œí¬ì¸íŠ¸ ì‘ë‹µ
- âœ… ì¸ì¦ ì‹œìŠ¤í…œ
- âœ… ì—ëŸ¬ ì²˜ë¦¬
- âœ… íŠ¸ëœì­ì…˜ ë¼ì´í”„ì‚¬ì´í´

11.2 Jest í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ ì„¤ì •:
- ì„¤ì¹˜ ì™„ë£Œ, í…ŒìŠ¤íŠ¸ ì½”ë“œ ë¯¸êµ¬í˜„
- í–¥í›„ ë‹¨ìœ„/í†µí•© í…ŒìŠ¤íŠ¸ ì¶”ê°€ ê°€ëŠ¥

================================================================================
12. í–¥í›„ í™•ì¥ ê³„íš
================================================================================

12.1 í”„ë¡œë•ì…˜ ë°°í¬ë¥¼ ìœ„í•œ ì¶”ê°€ ì‘ì—…:
- ì‹¤ì œ Fabric ë„¤íŠ¸ì›Œí¬ ì—°ê²°
- TLS/SSL ì¸ì¦ì„œ ì„¤ì •
- ë¡œë“œ ë°¸ëŸ°ì„œ êµ¬ì„±
- ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ (Prometheus/Grafana)
- CI/CD íŒŒì´í”„ë¼ì¸

12.2 ê¸°ëŠ¥ í™•ì¥:
- WebSocket ì‹¤ì‹œê°„ ì•Œë¦¼
- ë°°ì¹˜ ì²˜ë¦¬ ì‹œìŠ¤í…œ
- ë°ì´í„° ë¶„ì„ ë° ë¦¬í¬íŒ…
- ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ

================================================================================
13. ìµœì¢… ìƒíƒœ ë° ê²€ì¦
================================================================================

ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤:
- API Gateway: http://localhost:3001 âœ…
- Redis Container: localhost:6379 âœ…
- Background Processes: ì •ìƒ ì‹¤í–‰ ì¤‘

í”„ë¡œì íŠ¸ ì™„ì„±ë„: 100%
- âœ… ëª¨ë“  ê³„íšëœ ê¸°ëŠ¥ êµ¬í˜„
- âœ… íƒ€ì… ì•ˆì „ì„± í™•ë³´
- âœ… ì—ëŸ¬ ì²˜ë¦¬ ì™„ë£Œ
- âœ… í…ŒìŠ¤íŠ¸ ê²€ì¦ ì™„ë£Œ
- âœ… ë¬¸ì„œí™” ì™„ë£Œ

íŒŒì¼ ìƒì„±/ìˆ˜ì • í†µê³„:
- ìƒì„±ëœ íŒŒì¼: 19ê°œ
- ìˆ˜ì •ëœ íŒŒì¼: 0ê°œ (ì‹ ê·œ í”„ë¡œì íŠ¸)
- ì´ ì½”ë“œ ë¼ì¸: ì•½ 2,500ì¤„

================================================================================
ì¢…ë£Œ: 2025-09-16T15:01:00Z
í”„ë¡œì íŠ¸ ìƒíƒœ: ì™„ë£Œ ë° ì‹¤í–‰ ì¤‘
ë‹¤ìŒ ì„¸ì…˜ ì—°ê²°ì„±: ë³¸ ë¬¸ì„œë¥¼ í†µí•´ ì™„ì „í•œ ì—°ê²°ì„± ë³´ì¥
================================================================================